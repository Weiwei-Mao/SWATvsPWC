# SWAT+ vs PWC 模型选择与应用指南

**文档版本**: 1.0
**生成日期**: 2026-02-01

---

## 目录

1. [快速决策指南](#快速决策指南)
2. [场景选择矩阵](#场景选择矩阵)
3. [SWAT+ 使用指南](#swat-使用指南)
4. [PWC 使用指南](#pwc-使用指南)
5. [数据准备清单](#数据准备清单)
6. [模型校准建议](#模型校准建议)
7. [常见问题解答](#常见问题解答)

---

## 快速决策指南

### 选择SWAT+的情况

```
┌─────────────────────────────────────────────────────────────┐
│                    你的研究符合以下条件？                      │
├─────────────────────────────────────────────────────────────┤
│  □ 需要流域尺度的空间分布结果                               │
│  □ 需要同时模拟多种污染物(氮、磷、农药等)                     │
│  □ 研究区域数据有限                                         │
│  □ 需要进行长期连续模拟(多年)                                │
│  □ 需要评估不同管理措施的效果                                │
│  □ 需要修改或扩展模型代码                                    │
│  □ 预算有限，需要开源解决方案                                │
├─────────────────────────────────────────────────────────────┤
│                    如果符合≥3项 → 选择SWAT+                   │
└─────────────────────────────────────────────────────────────┘
```

### 选择PWC的情况

```
┌─────────────────────────────────────────────────────────────┐
│                    你的研究符合以下条件？                      │
├─────────────────────────────────────────────────────────────┤
│  □ 农药注册或再评估的监管需求                                │
│  □ 需要EPA认可的评估方法                                     │
│  □ 需要高精度的浓度预测                                       │
│  □ 田间尺度的精细模拟                                         │
│  □ 关注短时事件(暴雨径流)                                    │
│  □ 化学物质具有复杂特性(非线性吸附、挥发等)                    │
│  □ 需要完整的质量平衡和通量分解                              │
├─────────────────────────────────────────────────────────────┤
│                    如果符合≥3项 → 选择PWC                     │
└─────────────────────────────────────────────────────────────┘
```

---

## 场景选择矩阵

### 研究目标与模型适配

| 研究目标 | SWAT+ | PWC | 推荐模型 |
|---------|-------|-----|----------|
| **流域农药负荷估算** | ✅ 优秀 | ⚠️ 受限 | **SWAT+** |
| **农药风险评估** | ⚠️ 一般 | ✅ 优秀 | **PWC** |
| **管理措施情景分析** | ✅ 优秀 | ⚠️ 一般 | **SWAT+** |
| **监管合规评估** | ❌ 不认可 | ✅ EPA认可 | **PWC** |
| **短时事件分析** | ⚠️ 日步长限制 | ✅ 亚日步长 | **PWC** |
| **长期趋势分析** | ✅ 优秀 | ⚠️ 计算成本 | **SWAT+** |
| **空间分布分析** | ✅ 分布式 | ❌ 单点 | **SWAT+** |
| **多污染物综合评估** | ✅ 优秀 | ❌ 仅农药 | **SWAT+** |

### 数据条件与模型适配

| 数据条件 | SWAT+ | PWC | 说明 |
|---------|-------|-----|------|
| **数据丰富度要求** | 中等 | 高 | PWC需要更多参数 |
| **空间数据需求** | 高 | 低 | SWAT+需要空间分布数据 |
| **时间分辨率要求** | 日 | 日/小时 | PWC支持更高频率 |
| **农药物化数据** | 基本 | 详细 | PWC需要更多参数 |
| **土壤剖面数据** | 基本 | 详细 | PWC需要精确分层 |

### 农药特性与模型适配

| 农药特性 | SWAT+ | PWC | 说明 |
|---------|-------|-----|------|
| **挥发性农药** | ⚠️ 简化处理 | ✅ 完整模型 | **PWC** |
| **非线性吸附** | ❌ 不支持 | ✅ Freundlich | **PWC** |
| **复杂代谢链** | ✅ 支持 | ⚠️ 最多3种化学物质（母体+两代） | **SWAT+** |
| **强烈叶面持有** | ⚠️ 简化 | ✅ 详细 | **PWC** |
| **快速降解** | ⚠️ 日步长 | ✅ 亚日步长 | **PWC** |

---

## SWAT+ 使用指南

### 安装与配置

```bash
# 1. 克隆SWAT+仓库
git clone https://github.com/swat-model/swatplus.git

# 2. 安装依赖
# - gfortran 或 ifort/ifx 编译器
# - CMake 构建工具
# - make 工具

# 3. 构建模型
cd swatplus
mkdir build && cd build
cmake ..
make
```

### 输入文件准备

```
swatplus/
├── txtinputs/              # 输入文件目录
│   ├── file.cio           # 主控制文件
│   ├── weather*.wth       # 气象数据
│   ├── soil.sol           # 土壤参数
│   ├── plant.plt          # 植物参数
│   ├── pesticide.pes      # 农药数据库
│   ├── hru-data.hru       # HRU管理
│   ├── basin.fig          # 流域配置
│   └── channels.cha       # 河道参数
└── # 输出目录
```

### 农药数据库设置

**pesticide.pes 文件格式**:

```
Name        Koc    Washoff  Foliar_Hlife  Soil_Hlife  Solubility  Aq_Hlife  Aq_Volat  Mol_Wt
Atrazine    100     0.01     10.0          60.0        30.0        35.0      0.001     215.5
Glyphosate  24000   0.5      5.0           45.0        10500       7.0       0.0       169.1
```

### 农药管理操作

在 `hru-data.hru` 中定义:

```
# 农药施用操作
# 格式: 年 月 日 操作代码 农药编号 施用量(kg/ha)
2022 5 15  pesticide  1  2.5     # 5月15日施用2.5 kg/ha Atrazine
2022 6 1   pesticide  1  1.0     # 6月1日施用1.0 kg/ha Atrazine
```

### 运行模型

```bash
# SWAT+ 可执行文件
./swatplus

# 或使用QGIS SWAT+插件运行
```

### 输出结果

主要输出文件:

| 文件 | 描述 |
|------|------|
| `output.pst` | 农药平衡输出(日/月/年) |
| `channel_cha.pst` | 河道农药输出 |
| `aquifer.aq` | 含水层农药输出 |

### SWAT+ 优势场景

**最适合**:
- 农业面源污染评估
- 流域尺度的农药负荷估算
- 最佳管理措施(BMP)效果评估
- 长期趋势分析
- 多污染物综合评估

**不适合**:
- 监管风险评估(非EPA认可)
- 短时高精度事件模拟
- 复杂的挥发过程
- 非线性吸附化学物质

---

## PWC 使用指南

### 获取软件

```
PWC软件需要从EPA获取:
- PWC下载: https://www.epa.gov/pesticide-science-and-assessing-pesticide-risks/pesticide-root-zone-model-przm-overview
- 需要注册下载

或联系:
EPA's Office of Pesticide Programs
```

### 输入文件准备

```
PWC_Project/
├── *.PRZM            # PRZM输入文件(田间)
├── *.MET             # 气象数据文件
├── *.PEST            # 农药属性文件
├── *.SOL             # 土壤参数文件
├── *.EMC             # 作物管理文件
├── *.VVM             # VVWM配置文件
└── *.OUT             # 输出文件
```

### PRZM输入文件格式

```
RECORD 1:  项目标题
RECORD 2:  施用次数
RECORD 3:  施用参数 (日期, 方式, 量, 效率, 深度等)
RECORD 4:  土壤参数 (层数, 厚度, 容重, 有机碳等)
RECORD 5:  气象文件名
...
```

### 农药施用配置

**CAM代码选择**:
```
CAM 1: 土壤表面施用 - 适用于播后苗前
CAM 2: 叶面施用 - 适用于作物生长期
CAM 3: 均匀混施 - 适用于土壤处理
CAM 4: 特定深度 - 适用于条施/穴施
CAM 5: T-Band - 适用于种植带施药
```

### 运行PWC

```
方法1: Windows界面
- 打开PWC.exe
- 加载配置文件
- 运行模拟

方法2: 命令行
- PWC.exe input.przm
```

### 输出结果

主要输出:

| 输出 | 描述 | 单位 |
|------|------|------|
| `daily fluxes` | 日通量(径流、侵蚀、挥发等) | g/cm²/day |
| `daily mass` | 日质量平衡 | g/cm² |
| `EEC` | 预测环境浓度 | µg/L |
| `vvwm output` | 水体浓度 | µg/L |

### PWC 优势场景

**最适合**:
- 农药注册风险评估
- EPA监管合规评估
- 高精度浓度预测
- 短时事件(暴雨径流)模拟
- 挥发性农药评估
- 非线性吸附化学物质

**不适合**:
- 流域尺度评估(单点模型)
- 长期连续模拟(计算成本高)
- 空间分布分析
- 多污染物综合评估

---

## 数据准备清单

### SWAT+ 必需数据

```
□ 流域边界数据
  □ DEM数字高程模型
  □ 流域出口位置

□ 气象数据
  □ 日降雨量
  □ 日最高/最低气温
  □ 日太阳辐射
  □ 日风速
  □ 日相对湿度

□ 土壤数据
  □ 土壤类型图
  □ 土壤物理属性(容重、孔隙度、田间持水量、萎蔫点)
  □ 土壤有机质含量

□ 土地利用/土地覆盖数据
  □ 植被类型
  □ 管理措施

□ 农药数据
  □ 名称
  □ Koc
  □ 半衰期(叶面、土壤、水体)
  □ 水溶性
  □ 施用量和日期
```

### PWC 必需数据

```
□ 田间信息
  □ 经纬度
  □ 土壤剖面(分层厚度、容重、有机碳、含水量)
  □ 土壤水力参数(渗透率、持水量)

□ 气象数据(日数据)
  □ 降雨量
  □ 最高/最低气温
  □ 太阳辐射
  □ 风速
  □ 露点温度

□ 作物管理
  □ 种植/收获日期
  □ 作物类型
  □ 冠层发育(LAI动态)
  □ 灌溉安排

□ 农药数据
  □ Koc或Kd
  □ Henry常数
  □ 半衰期(土壤、叶面、水体、底泥)
  □ 水溶性
  □ 蒸气压
  □ 分子量
  □ 扩散系数(水、空气)
  □ Q10系数(可选)
  □ 代谢产物信息

□ 施用信息
  □ 施用日期时间
  □ 施用量
  □ 施用方式(CAM代码)
  □ 施用深度(如适用)
  □ 施用效率

□ 水体信息(如模拟受纳水体)
  □ 水体深度
  □ 水体体积
  □ 底泥深度
  □ 水力停留时间
```

---

## 模型校准建议

### SWAT+ 校准策略

**校准优先级**:
```
1. 水文校准
   └── 流量、蒸散发

2. 泥沙校准
   └── 泥沙产量

3. 农药校准
   └── 径流农药浓度
```

**敏感参数**:
| 参数 | 典型范围 | 校准建议 |
|------|----------|----------|
| `Koc` | 10-10000 mL/g | 文献值优先，微调 |
| `washoff` | 0.001-0.1 1/mm | 从叶面持水量估算 |
| `soil_hlife` | 10-180 天 | 实验室测定，Q10校正 |
| `aq_hlife` | 7-60 天 | 文献值 |
| `USLE K` | 0.1-0.6 | 从土壤质地估算 |

### PWC 校准策略

**校准优先级**:
```
1. 水分运动
   └── 渗透率、持水量、径流产生

2. 农药运移
   └── 分配系数、降解速率

3. 边界过程
   └── 挥发、植物吸收
```

**敏感参数**:
| 参数 | 典型范围 | 校准建议 |
|------|----------|----------|
| `KOC` | 10-10000 mL/g | 实验室测定 |
| `HENRYC` | 1E-7-1E-3 | 从VP和溶解度计算 |
| `HLF_S` | 10-180 天 | 实验室测定 |
| `WASHOFF_COEFF` | 0.01-0.2 1/cm | 田间观测 |
| `GAMMA1` | 0-1 | 文献值 |

### 校准数据需求

| 精度等级 | SWAT+ | PWC |
|---------|-------|-----|
| **粗略** | 流域出口负荷 | 单点浓度 |
| **中等** | HRU负荷分布 | 日浓度变化 |
| **精细** | 日负荷 + 过程线 | 小时浓度 + 通量 |

---

## 常见问题解答

### 模型选择问题

**Q: 能否同时使用SWAT+和PWC？**

A: 可以，有几种方式:
1. **嵌套使用**: SWAT+模拟流域，PWC模拟关键区域
2. **结果验证**: 用PWC高精度结果验证SWAT+
3. **互补分析**: SWAT+做空间分析，PWC做风险评估

**Q: 哪个模型更准确？**

A: 取决于评估对象:
- **田间浓度预测**: PWC通常更准确(精细物理过程)
- **流域负荷估算**: SWAT+更全面(空间分布式)
- **长期趋势**: 两者都可，SWAT+效率更高

### 数据问题

**Q: 缺乏详细农药物化参数怎么办？**

A: 参考以下优先级:
1. 实验室测定(最准确)
2. PPDB/USDA数据库(推荐)
3. 从结构参数估算(QSPR方法)
4. 同类化合物类比

**Q: 空间数据不足能否用SWAT+？**

A: 可以:
- 使用全球数据集(HWSD, GlobCover)
- 简化HRU划分
- 聚合土地类型
- 但结果不确定性会增加

### 技术问题

**Q: SWAT+日步长是否太粗糙？**

A: 对于大部分情况足够:
- 农药运移通常由日降雨事件驱动
- 日步长能捕捉主要过程
- 除非研究极快速过程(如强挥发事件)

**Q: PWC计算时间太长怎么办？**

A: 优化策略:
1. 减少模拟重复次数
2. 使用代表性天气情景
3. 简化土壤分层(保持总深度)
4. 固定时间步长而非自适应

---

## 决策流程图

```
                     研究目标？
                        │
        ┌───────────────┼───────────────┐
        │               │               │
    监管评估          流域评估        其他研究
        │               │               │
        ▼               ▼               ▼
     ┌─────┐       ┌─────────┐     ┌─────────┐
     │ PWC │       │ SWAT+   │     │ 数据评估 │
     └─────┘       └─────────┘     └─────────┘
                                      │
                          ┌───────────┼───────────┐
                          │           │           │
                       数据充足    数据中等     数据有限
                          │           │           │
                          ▼           ▼           ▼
                       ┌─────┐    ┌─────────┐  ┌─────┐
                       │ PWC │    │ SWAT+   │  │SWAT+ │
                       └─────┘    └─────────┘  └─────┘
```

---

## 模型对比总结表

| 维度 | SWAT+ | PWC |
|------|-------|-----|
| **空间尺度** | 流域/子流域/HRU | 单点/田块 |
| **时间步长** | 日 | 日/小时(亚日) |
| **开源状态** | 完全开源 | 非完全开源（软件需EPA获取，源码不完整公开） |
| **监管认可** | 不认可 | EPA认可 |
| **计算效率** | 高 | 中等 |
| **数据需求** | 中等 | 高 |
| **学习曲线** | 中等 | 陡峭 |
| **农药施用** | 3种方式 | 8种方式 |
| **挥发模拟** | 简化 | 完整模型 |
| **吸附模型** | 线性 | 线性+非线性 |
| **降解模拟** | 一级动力学 | 三相+温度校正 |
| **水文耦合** | 显式 | 隐式紧耦合 |
| **输出内容** | 负荷+浓度 | 浓度+详细通量 |
| **综合能力** | 多污染物 | 仅农药 |
| **扩展性** | 高 | 低 |

---

## 推荐阅读

1. **SWAT+ 文档**:
   - [SWAT+ Input/Output Documentation](https://swatplus.gitbook.io/docs)
   - [SWAT+ Source Code Documentation](https://swat-model.github.io/swatplus)
   - [Texas A&M SWAT Resources](https://swat.tamu.edu)

2. **PWC 文档**:
   - [PWC User Manual (EPA, 2015)](https://19january2021snapshot.epa.gov/sites/static/files/2015-12/documents/pwc_user_manual_12-8-15.pdf)
   - [PRZM3 Documentation](https://www.epa.gov/pesticide-science-and-assessing-pesticide-risks/pesticide-root-zone-model-przm-overview)

3. **科学文献**:
   - Rathjens et al. (2025). Extending SWAT2012 and SWAT+ models. *Hydrology and Earth System Sciences*.
   - Bannwarth et al. (2014). Pesticide transport simulation in a tropical catchment by SWAT.
   - EPA (2015). Models for Pesticide Risk Assessment.

---

*文档结束*
