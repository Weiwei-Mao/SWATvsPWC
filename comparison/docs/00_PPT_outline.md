# SWAT+ vs PWC 农药模型对比 (PPT提纲)

---

## 第1页：标题

**SWAT+ vs PWC 农药运移模型对比**
- 基于源代码分析
- 物理过程与算法差异
- 模型选择建议

---

## 第2页：模型基本信息

| 特征 | SWAT+ | PWC |
|------|-------|-----|
| **开发机构** | USDA-ARS + Texas A&M | US EPA |
| **开源状态** | 完全开源 | 非完全开源（软件需EPA获取，源码不完整公开） |
| **空间尺度** | 流域/子流域/HRU (分布式) | 单点/田块 |
| **时间步长** | 固定日步长 | 支持亚日步长细分 |
| **设计目标** | 综合流域模拟 | 农药风险评估 |

---

## 第3页：一次运行可求解的农药数量

### PWC
- **最多3种化学物质**
- 结构：1种母体 + 2代代谢产物
  - Parent (母体)
  - Daughter (第一代代谢产物)
  - Granddaughter (第二代代谢产物)
- 代码证据：
```fortran
If (nchem == 2 .or. nchem == 3) THEN  !Daughter
If (nchem == 3) THEN                   !Granddaughter
```

### SWAT+
- **支持多种农药同时模拟**
- 每种农药可有多个代谢产物
- 代码证据：
```fortran
do ipest = 1, cs_db%num_pests  ! 循环所有农药
type (daughter_decay_fractions), dimension(:), allocatable :: daughter
```

**结论**：SWAT+可同时模拟更多农药种类

---

## 第4页：水文-溶质耦合方式

### PWC：顺序耦合（先水文后溶质）

```
┌─────────────────────────────────────────────────────────┐
│                   每日循环                              │
└─────────────────────────────────────────────────────────┘
           │
           ▼
┌─────────────────────┐
│  1. 先算水          │  field_hydrology.f90
│  - runoff_leaching  │  hydrology_only
│  - 渗透、径流、蒸散 │
└─────────────────────┘
           │
           ▼
┌─────────────────────┐
│  2. 再算溶质        │  Chemica_Transport.f90
│  - 使用已算好的     │  chemical_transport_oneday
│    水文变量         │
└─────────────────────┘
           │
           ▼
┌─────────────────────┐
│  3. 输出到水体(VVWM)│
└─────────────────────┘
```

**特点**：先水文后溶质；溶质运移使用隐式三对角与亚日步长求解

### SWAT+：顺序耦合

```
┌─────────────────────────────────────────────────────────┐
│                   每日循环                              │
└─────────────────────────────────────────────────────────┘
           │
           ▼
┌─────────────────────┐
│  1. 水文模块        │  独立计算
│  - 产流、蒸散、渗流 │
└─────────────────────┘
           │
           ▼
┌─────────────────────┐
│  2. 农药模块        │  使用水文结果
│  - 读取水文变量     │
│  - 计算农药运移     │
└─────────────────────┘
```

**结论**：两者都是顺序耦合；PWC在溶质方程上采用更精细的隐式数值求解

---

## 第5页：PWC考虑的物理过程

### 田间过程 (PRZM/TPEZ)

```
农药施用
    │
    ▼
┌────────────────────────────────────────────────────────┐
│                    土壤剖面                            │
├────────────────────────────────────────────────────────┤
│  ┌────────┐  ┌────────┐  ┌────────┐  ┌────────┐     │
│  │叶面冲刷│→│土壤吸附 │→│降解    │→│挥发    │     │
│  └────────┘  └────────┘  └────────┘  └────────┘     │
│       │           │           │           │          │
│       ▼           ▼           ▼           ▼          │
│    WOFLUX     Sorbed     DKFLUX     PVFLUX            │
│   (冲刷)     (吸附)     (三相降解)  (挥发)             │
│                                                        │
│       │           │           │           │          │
│       └───────────┴───────────┴───────────┘          │
│                      │                                │
│                      ▼                                │
│              ┌───────────────┐                        │
│              │   运移过程    │                        │
│              ├───────────────┤                        │
│              │ • 径流 ROFLUX │                        │
│              │ • 侵蚀 ERFLUX │                        │
│              │ • 淋溶 DCOFLUX│                        │
│              │ • 植物吸收    │                        │
│              │   UPFLUX     │                        │
│              └───────────────┘                        │
└────────────────────────────────────────────────────────┘
```

### 三相降解模型

| 相 | 降解速率 | 描述 |
|----|----------|------|
| 水相 | DWRATE | 溶解态降解 |
| 吸附相 | DSRATE | 土壤颗粒吸附态降解 |
| 气相 | DGRATE | 土壤空气中降解 |

### 降解产物链

```
Parent
  │ (foliar_fr, soil_fr, aq_fr, ben_fr)
  ▼
Daughter
  │ (foliar_fr, soil_fr, aq_fr, ben_fr)
  ▼
Granddaughter
```

---

## 第6页：SWAT+考虑的物理过程

### HRU尺度过程

```
农药施用
    │
    ▼
┌────────────────────────────────────────────────────────┐
│                    HRU (田间单元)                     │
├────────────────────────────────────────────────────────┤
│  ┌────────┐  ┌────────┐  ┌────────┐  ┌────────┐     │
│  │叶面降解 │→│土壤降解 │→│冲刷    │→│植物吸收│     │
│  │decay_f │  │decay_s │  │wash   │  │pl_uptake│    │
│  └────────┘  └────────┘  └────────┘  └────────┘     │
│                                                        │
│              ┌──────────────────┐                     │
│              │   运移输出路径   │                     │
│              ├──────────────────┤                     │
│              │ • 地表径流 surq  │                     │
│              │ • 侧向流   latq  │                     │
│              │ • 排水     tileq │                     │
│              │ • 淋溶     perc  │                     │
│              │ • 泥沙     sed   │                     │
│              └──────────────────┘                     │
└────────────────────────────────────────────────────────┘
```

### 河道过程

```
┌────────────────────────────────────────────────────────┐
│                      河道                             │
├────────────────────────────────────────────────────────┤
│  • 反应 react    (水体降解)                           │
│  • 代谢 metab    (母体→子体)                          │
│  • 挥发 volat                                       │
│  • 沉降 settle                                       │
│  • 再悬浮 resus                                       │
│  • 扩散 difus        (底泥-水交换)                    │
│  • 底泥反应 react_bot                                │
│  • 底泥掩埋 bury                                      │
└────────────────────────────────────────────────────────┘
```

### 代谢产物

```
Parent
  │ (foliar_fr, soil_fr, aq_fr, ben_fr)
  ▼
多个 Daughter (可配置)
```

---

## 第7页：农药施用方式对比

### PWC：8种精细施用方式

| CAM | 方式 | 描述 |
|-----|------|------|
| 1 | 土壤表面 | 线性递减至4cm |
| 2 | 叶面施用 | 冠层截留 + 地面递减 |
| 3 | 均匀混施 | 均匀分布至指定深度 |
| 4 | 特定深度 | 全部置于指定深度 |
| 5 | T-Band | 顶部2cm集中 + 下层均匀 |
| 6 | 线性递减 | 按深度线性递减 |
| 7 | 线性递增 | 按深度线性递增 |
| 8 | 自定义 | 用户定义混施深度 |

### SWAT+：3种基本方式

- 叶面施用 (按LAI分配)
- 土壤表面施用
- 土壤混施

**结论**：PWC施用方式更精细

---

## 第8页：挥发过程对比

### PWC：完整的冠层阻力模型

```
土壤表面
    │
    ▼
┌─────────────────────────────────────────┐
│  Henry定律分配: C_air = C_water × H     │
└─────────────────────────────────────────┘
    │
    ▼
┌─────────────────────────────────────────┐
│  空气相扩散                             │
│  DGAIR = DAIR × (孔隙度)^(10/3)         │
└─────────────────────────────────────────┘
    │
    ▼
┌─────────────────────────────────────────┐
│  边界层阻力                             │
│  R_boundary = d / D_air                 │
└─────────────────────────────────────────┘
    │
    ▼
┌─────────────────────────────────────────┐
│  冠层阻力模型 (有植被时)                │
│  • Richardson数 → 大气稳定度            │
│  • 摩擦速度 u*                          │
│  • 热涡动扩散                          │
│  • 分层积分阻力                         │
└─────────────────────────────────────────┘
    │
    ▼
通量 = -CONDUC × C × H
```

### SWAT+：简化挥发

```
水体挥发
Flux = -aq_volat × C
```
仅在水体和水库中考虑，使用简化的挥发系数

**结论**：PWC挥发模型更完整

---

## 第9页：吸附过程对比

### PWC

| 特性 | 描述 |
|------|------|
| 线性吸附 | S = Kd × C |
| Freundlich非线性 | S = Kf × C^N |
| 非平衡吸附 | 双域模型（移动域+不可移动域） |
| 预测-校正器 | 处理非线性 |

### SWAT+

| 特性 | 描述 |
|------|------|
| 线性吸附 | S = Kd × C |
| Kd计算 | Kd = Koc × OC%/100 |
| 非线性 | ❌ 不支持 |
| 非平衡 | ❌ 不支持 |

**结论**：PWC吸附模型更复杂

---

## 第10页：数值方法对比

| 方面 | SWAT+ | PWC |
|------|-------|-----|
| **时间积分** | 显式欧拉 | 预测-校正器 |
| **亚日步长** | ❌ 固定日步长 | ✅ 支持细分 |
| **对流-扩散** | 简化一阶 | 三对角矩阵 |
| **非线性处理** | 线性化 | 迭代求解 |
| **质量守恒** | 近似 | 精确 |

---

## 第11页：输出结果对比

### PWC输出

```
通量:
  ROFLUX  - 径流通量 (g/cm²/day)
  ERFLUX  - 侵蚀通量 (g/cm²/day)
  PVFLUX  - 挥发通量 (g/cm²/day)
  DKFLUX  - 降解通量 (g/cm²/day)
  WOFLUX  - 冲刷通量 (g/cm²/day)
  UPFLUX  - 植物吸收通量 (g/cm²/day)
  DCOFLUX - 底部出流 (g/cm²/day)
  SRCFLX  - 降解产物生成 (g/cm²/day)

浓度:
  EEC - 预测环境浓度 (µg/L)
```

### SWAT+输出

```
质量平衡:
  plant, soil, sed, surq, latq, tileq, perc
  apply_s, apply_f
  decay_s, decay_f, wash
  metab_s, metab_f, pl_uptake

河道:
  溶解态出流, 吸附态出流
  反应, 代谢, 挥发, 沉降, 再悬浮, 扩散
```

---

## 第12页：模型选择决策树

```
                       研究目标？
                          │
        ┌─────────────────┼─────────────────┐
        │                 │                 │
    监管评估           流域评估          其他
        │                 │                 │
        ▼                 ▼                 ▼
    ┌───────┐        ┌─────────┐      ┌─────────┐
    │  PWC  │        │  SWAT+  │      │ 数据评估 │
    └───────┘        └─────────┘      └─────────┘
                                             │
                               ┌─────────────┼─────────────┐
                               │             │             │
                            数据充足      数据中等      数据有限
                               │             │             │
                               ▼             ▼             ▼
                            ┌─────┐      ┌─────────┐   ┌─────┐
                            │ PWC │      │  SWAT+  │   │SWAT+│
                            └─────┘      └─────────┘   └─────┘
```

---

## 第13页：场景对比矩阵

| 场景 | SWAT+ | PWC | 推荐 |
|------|-------|-----|------|
| 流域农药负荷 | ✅ | ❌ | SWAT+ |
| 农药风险评估 | ⚠️ | ✅ | PWC |
| 管理措施评估 | ✅ | ⚠️ | SWAT+ |
| 监管合规 | ❌ | ✅ | PWC |
| 短时事件 | ⚠️ | ✅ | PWC |
| 长期趋势 | ✅ | ⚠️ | SWAT+ |
| 空间分布 | ✅ | ❌ | SWAT+ |
| 多污染物 | ✅ | ❌ | SWAT+ |
| 挥发性农药 | ⚠️ | ✅ | PWC |
| 非线性吸附 | ❌ | ✅ | PWC |

---

## 第14页：核心差异总结

| 维度 | SWAT+ | PWC |
|------|-------|-----|
| **农药数量** | 多种 | 1+2代谢产物 |
| **空间尺度** | 分布式 | 单点 |
| **挥发** | 简化 | 完整模型 |
| **吸附** | 线性 | 线性+非线性 |
| **降解** | 单相 | 三相 |
| **施用方式** | 3种 | 8种 |
| **时间步长** | 日 | 支持亚日 |
| **监管认可** | ❌ | EPA ✅ |

---

## 第15页：Q&A

**可能的问题**：

Q1: 能否同时使用两个模型？
A1: 可以嵌套使用，SWAT+做流域分析，PWC做关键点详细评估

Q2: 哪个更准确？
A2: 取决于评估目标。田间浓度预测PWC更准，流域负荷SWAT+更全面

Q3: 如何选择？
A3: 看研究目标、数据条件、是否需要监管认可

---

*文档结束*
